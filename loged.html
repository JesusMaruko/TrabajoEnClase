<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loged</title>
    <script src="https://unpkg.com/vue@3"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
</head>
<body>
    <div id="contenedor">
        <div class="container text-center">
            <div class="row align-items-center">
                <div class="card" style="width: 18rem;" v-for="peliculas in movies" >
                    <img class="card-img-top" :src="'https://image.tmdb.org/t/p/w600_and_h900_bestv2' + peliculas.poster_path">
                    <div class="card-body">
                    <h5 class="card-title">
                        {{peliculas.title}}
                    </h5>
                    <p class="card-text">{{peliculas.release_date}}</p>
                    <button class="btn btn-primary" @click="verDetalles(peliculas)">Ver m√°s detalles</button>
                    </div>
                </div>
            </div>
        </div>    
    </div>
    <script type="text/javascript">
        var miStorage = window.localStorage;
        
        const { createApp } = Vue;
        const data = null;
        const error = null;
        
                
        const app = createApp({
                    data() {
                        return {
                            movies: null,
                            nombreUsuario: localStorage.getItem("usuario"),
                           
                        }
                },
                    methods:{
                        verDetalles(peli){
                            localStorage.setItem("idPeli", peli.id);
                            console.log(localStorage.getItem("idPeli"));
                            window.location.href = "detalle.html";
                        }
                    },
                    mounted(){
                        var config = {
                                method: 'get',
                                url: 'https://api.themoviedb.org/3/movie/popular?&language=es-MX',
                                headers: { 
                                    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI3ODU5ZTM3MDNkNmE3MDMzMmMzMWFlMGY3NDc3MmIwZCIsInN1YiI6IjYzMWYzMTZlNTY4NDYzMDA4M2NkMzNjNyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Ut-9on88blYiY4pe53dKArzyO-zOE5BFE5j3JEo1AwM', 
                                    
                                },
                                
                                };
                                
                                axios(config)
                                .then(function (response) {
                                app.movies = response.data.results;
                                
                                })
                                .catch(function (error) {
                                console.log(error);
                                });
                    }
                }).mount('#contenedor')
    </script>
</body>
</html>